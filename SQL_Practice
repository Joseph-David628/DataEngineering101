Q9 
select
    o_year,
    sum(case
            when nation = 'ARGENTINA'
            then volume
            else 0 end) / sum(volume) as market_share
from (
    select strftime('%Y', o_orderdate) as o_year,
        sum(l_extendedprice * (1-l_discount)) as volume,
        n_name as nation
    from
        orders,
        lineitem,
        supplier, 
        part, 
        nation,
        region
    where
        l_suppkey = s_suppkey
        and s_nationkey = n_nationkey
        and n_regionkey = r_regionkey
        and l_orderkey = o_orderkey
        and (strftime('%Y', o_orderdate) = '1995' or strftime('%Y', o_orderdate) = '1996')
        and r_name = 'AMERICA'
        and p_type = 'ECONOMY PLATED TIN'
)
group by
    o_year
order by 
    o_year
